{
    "model_path": "/mnt/DataSSD/AI/models/RaiFlow/RaiFlow",
    "model_type": "raiflow",
    "latent_type": "jpeg",
    "embed_type": "token",
    "sampler_config": {
        "weighting_scheme": "mode",
        "logit_mean": -0.2,
        "logit_std": 1.5,
        "mode_scale": 0.64,
        "timestep_bias": 0.5,
        "shift": 2.5
    },
    "loss_weighting": "none",
    "sensitive_keys": [],
    "override_sensitive_keys": false,
    "optimizer": "sdnq.optim.CAME",
    "optimizer_args": {"weight_decay": 0.01, "use_quantized_buffers": true, "quantized_buffers_dtype": "uint8", "offload_buffers": true},
    "optimizer_args_sensitive": {"weight_decay": 0.01, "use_quantized_buffers": true, "quantized_buffers_dtype": "uint8", "offload_buffers": true},
    "fused_optimizer": true,
    "optimizer_cpu_offload": false,
    "optimizer_offload_gradients": false,
    "lr_scheduler": "SequentialLR",
    "lr_scheduler_args": {
        "milestones": [32], "schedulers": ["LinearLR", "CosineAnnealingLR"],
        "args": [{"start_factor": 0.01, "end_factor": 1, "total_iters": 32}, {"T_max": 10240000, "eta_min": 4e-7}]
    },
    "epochs": 100,
    "learning_rate": 4e-5,
    "learning_rate_sensitive": 2e-5,
    "max_grad_norm": 0.0,
    "skip_grad_norm": 0.0,
    "skip_grad_norm_steps": 5120,
    "max_grad_clip": 0.0,
    "log_grad_stats": false,
    "do_nan_embed_check": false,
    "loss_type": "mse",
    "loss_reduction": "mean",
    "dropout_rate": 0.0,
    "mask_rate": 0.0,
    "mask_high_rate": 8,
    "mask_low_rate": -2,
    "self_correct_rate": 0.0,
    "batch_size": 32,
    "gradient_accumulation_steps": 1,
    "gradient_checkpointing": true,
    "weights_dtype": "float16",
    "mixed_precision": "no",
    "use_grad_scaler": true,
    "quantization_config": {
        "weights_dtype": "uint16",
        "quantized_matmul_dtype": "int8",
        "group_size": 32,
        "svd_rank": 32,
        "use_svd": false,
        "use_quantized_matmul": false,
        "use_static_quantization": true,
        "use_stochastic_rounding": true,
        "non_blocking": false,
        "add_skip_keys": true,
        "modules_to_not_convert": [],
        "modules_dtype_dict": {}
    },
    "dynamo_backend": "no",
    "tunableop": null,
    "cudnn_enabled": true,
    "allow_tf32": true,
    "allow_reduced_precision": true,
    "flash_sdp": true,
    "mem_efficient_sdp": true,
    "dynamic_sdp": false,
    "math_sdp": true,
    "math_sdp_reduction": true,
    "ema_decay": 0.99,
    "ema_update_steps": 4,
    "use_ema": true,
    "use_foreach_ema": false,
    "update_ema_on_cpu": false,
    "offload_ema_to_cpu": true,
    "offload_ema_non_blocking": false,
    "offload_ema_pin_memory": false,
    "ema_weights_dtype": "float16",
    "gc_steps": 64,
    "checkpoint_save_steps": 256,
    "checkpoints_limit": 50,
    "max_load_workers": 2,
    "load_queue_lenght": 64,
    "reshuffle": true,
    "do_file_check": true,
    "use_latent_dataset": true,
    "use_embed_dataset": true,
    "encode_latents_with_cpu": false,
    "encode_embeds_with_cpu": false,
    "offload_latent_encoder_to_cpu": false,
    "offload_latent_encoder_non_blocking": false,
    "offload_latent_encoder_non_blocking_cpu": false,
    "offload_embed_encoder_to_cpu": false,
    "offload_embed_encoder_non_blocking": false,
    "offload_embed_encoder_non_blocking_cpu": false,
    "offload_diffusion_model_to_cpu": false,
    "offload_diffusion_model_non_blocking": false,
    "offload_diffusion_model_non_blocking_cpu": false,
    "latent_encoder_dtype": "float32",
    "embed_encoder_dtype": "bfloat16",
    "quantize_embed_encoder": true,
    "embed_encoder_quantization_config": {
        "weights_dtype": "int8",
        "quantized_matmul_dtype": "int8",
        "group_size": 0,
        "svd_rank": 32,
        "svd_steps": 8,
        "dynamic_loss_threshold": 2e-4,
        "use_svd": false,
        "use_quantized_matmul": false,
        "use_dynamic_quantization": false,
        "non_blocking": false,
        "add_skip_keys": true,
        "modules_to_not_convert": [],
        "modules_dtype_dict": {}
    },
    "log_with": "wandb",
    "project_name": "raiflow",
    "resume_from": "latest",
    "dataset_index": "cache/dataset_index_256_32.json",
    "project_dir": "/mnt/DataSSD/AI/models/RaiFlow/train_model",
    "dataset_paths": [
        {
            "path": "/mnt/DataSSD/AI/anime_image_dataset/dataset/danbooru/danbooru-jxl",
            "bucket_list": "/mnt/DataSSD/AI/anime_image_dataset/dataset/danbooru/metadata/bucket_list-256px.json",
            "text_embeds": [
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/danbooru/danbooru-florence2", "repeats": 3},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/danbooru/danbooru-wd", "repeats": 2},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/danbooru/danbooru-wd-medium", "repeats": 2},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/danbooru/danbooru-wd-short", "repeats": 2},
                    {"path": "empty_embed", "repeats": 1}
                ],
            "repeats": 1
        },
        {
            "path": "/mnt/DataSSD/AI/anime_image_dataset/dataset/anime-pictures/anime-pictures-jxl",
            "bucket_list": "/mnt/DataSSD/AI/anime_image_dataset/dataset/anime-pictures/metadata/bucket_list-256px.json",
            "text_embeds": [
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/anime-pictures/anime-pictures-florence2", "repeats": 3},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/anime-pictures/anime-pictures-wd", "repeats": 2},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/anime-pictures/anime-pictures-wd-medium", "repeats": 2},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/anime-pictures/anime-pictures-wd-short", "repeats": 2},
                    {"path": "empty_embed", "repeats": 1}
                ],
            "repeats": 1
        },
        {
            "path": "/mnt/DataSSD/AI/anime_image_dataset/dataset/pixiv/pixiv-jxl",
            "bucket_list": "/mnt/DataSSD/AI/anime_image_dataset/dataset/pixiv/metadata/bucket_list-256px.json",
            "text_embeds": [
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/pixiv/pixiv-florence2", "repeats": 3},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/pixiv/pixiv-wd", "repeats": 2},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/pixiv/pixiv-wd-medium", "repeats": 2},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/pixiv/pixiv-wd-short", "repeats": 2},
                    {"path": "empty_embed", "repeats": 1}
                ],
            "repeats": 1
        },
        {
            "path": "/mnt/DataSSD/AI/anime_image_dataset/dataset/vncg/vncg-jxl",
            "bucket_list": "/mnt/DataSSD/AI/anime_image_dataset/dataset/vncg/metadata/bucket_list-256px.json",
            "text_embeds": [
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/vncg/vncg-qwen3", "repeats": 2},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/vncg/vncg-florence2", "repeats": 2},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/vncg/vncg-wd", "repeats": 2},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/vncg/vncg-wd-medium", "repeats": 2},
                    {"path": "/mnt/DataSSD/AI/anime_image_dataset/captions/vncg/vncg-wd-short", "repeats": 1},
                    {"path": "empty_embed", "repeats": 1}
                ],
            "repeats": 1
        }
    ]
}
